## 프롬프트: 유튜버 인베스트 마켓 v1 — 요구사항/정의서 (FV 비가격반영 + 공모가/발행량 + 공급 애매함 해소)

나는 “유튜버 인베스트 마켓”이라는 웹 서비스를 만들고 있다. 유저는 유튜브 크리에이터(채널)를 하나의 거래 자산(종목)으로 보고, 가상 화폐로 매수/매도하며 수익을 경쟁한다. 주식/코인 거래소 감성을 참고하되, 이 서비스는 게임이므로 자체 규칙을 가진다.

핵심 목표:

* **가격은 오직 거래(체결)로만 형성·변동되어야 한다.**
* YouTube 지표로 계산되는 펀더멘털(FV)은 **가격을 직접 결정하거나, 가격을 FV로 앵커링/강제 조정하면 안 된다.**
* 다만 **상장(처음 종목을 만들 때 / 새 유튜버를 추가할 때)**에는 애매함을 피하기 위해 **공모가(초기 시장가, P0)**와 **발행량(총 공급량)**을 반드시 정의한다.
* 유저에게는 가입 시 **1인당 100,000 포인트(초기 자본)**를 지급한다.

---

### 1) 핵심 컨셉

* 각 유튜브 채널은 하나의 **거래 자산(Creator Asset)**이다.
* 유저는 가상 화폐로 자산을 매수/매도한다.
* 가격은 YouTube 지표나 FV가 아니라, **시장 참여자들의 거래로만** 변한다.
* YouTube 지표/FV는 아래 용도로만 사용한다:

  * 검색/발견(Discovery)
  * 랭킹/추천(Ranking)
  * 차트/트렌드(Trends)
  * 라벨링(성장/변동성/활동성 등)
  * (선택) 업데이트 우선순위(활성 종목군 선정)
* **금지:** FV/지표가 MP를 직접 설정하거나 FV 방향으로 되돌리는 앵커(Mean Reversion)로 작동하는 메커니즘.

---

### 2) 데이터(오라클)와 저장

* 데이터 소스는 **YouTube Data API**(공개 데이터)이다.
* 크리에이터별 최신값 저장:

  * 구독자 수, 누적 조회수, 누적 영상 수
  * `lastSyncedAt`
* 히스토리 저장(추세/성장률 계산):

  * `CreatorStat`: (예: 일별) subs/views/videos 기록
* 스케일 관점:

  * 크리에이터 수가 수만 명(예: 3만)까지 늘 수 있다.
  * DB 쓰기는 가능하지만 **YouTube API 쿼터가 병목**이 될 수 있다.
  * “활성/비활성 종목” 기반 업데이트 우선순위를 허용한다(단, 가격 앵커링 금지).

---

### 3) 시장가격(MP) 정의: 반드시 거래로만 형성

* **Market Price(MP)**는 유일한 “가격”이며, 거래 체결 단가/포트폴리오 평가에 사용한다.
* MP는 오직 **실제로 실행된 매수/매도(체결)**에 의해 변한다.
* FV/YouTube 지표가 MP를 직접 설정하거나 MP를 FV 방향으로 되돌리는 앵커로 작동하면 안 된다.

---

### 4) 공모가/초기 시장가(P0) 정의 (상장 시 필수)

새로운 크리에이터 자산을 상장(Listing)할 때, 시장이 애매해지지 않도록 초기값을 고정한다.

* 상장 시점에는 반드시 **초기 시장가(공모가, P0)**를 산출·기록한다.
* P0는 “상장 시점의 초기 조건(Initial Condition)”이며,
  **상장 이후 MP는 P0와 무관하게 거래로만 변한다.**
* P0 산출에는 다음 요소들을 모두 반영하는 단일식을 사용한다:

  * 구독자 수
  * 누적 조회수
  * 최근 조회수(예: 최근 30일 증가 조회수 = views_today - views_30d_ago)
  * (가능하면) 쇼츠 조회수는 **기존 조회수의 1/10 영향력**으로 반영

    * 예: `recentViews = recentLongViews + 0.1 * recentShortsViews`

---

### 5) 발행량(공급량) 정의: “가치”가 아니라 “단위/유동성 설계 파라미터”

유튜버 자산에는 현실처럼 자연 발행량이 없으므로, 발행량을 “가치”로 해석하지 않고 다음처럼 정의한다:

* 발행량(supply)은 **희소성의 정답**이 아니라,
  **거래 단위/분할성(denomination)/포트폴리오 표현 및 시장 안정성(유동성) 설계를 위한 정책 값**이다.
* “총발행량을 크게 잡으면 다 나가기 전까지 가격이 안 오른다”는 상점형 사고를 피한다.
  가격은 공급 소진이 아니라 **체결 기반 가격 업데이트 규칙**으로 움직인다.

상장 시 반드시 고정할 값:

1. `TOTAL_SUPPLY` (총 발행량)
2. `FLOAT` 또는 `CIRCULATING_SUPPLY` (초기 유통 가능량/시장 풀)
3. `RESERVE_SUPPLY` = TOTAL_SUPPLY - FLOAT

v1 권장 정책(애매함 최소화):

* **모든 종목의 TOTAL_SUPPLY는 동일하게 고정한다** (예: 1,000,000 등)

  * 단, 유저 1인당 100,000 포인트 지급과 밸런스를 고려해 TOTAL_SUPPLY의 크기를 조정 가능하다.
* 초기 유통량 비율도 고정한다 (예: 20% 유통, 80% 리저브).
* 초기 시가총액(표시용): `MARKET_CAP0 = P0 × TOTAL_SUPPLY`
* 부족 문제는 **소수점 거래 허용(코인 스타일)**로 해결할 수 있다.

  * 예: 최소 거래 단위 0.01 또는 0.001

---

### 6) 거래(Trading) v1: 단순 모델

* 복잡한 오더북/AMM 없이도 가능.
* 최소 요구:

  * 즉시 체결 기반 매수/매도
  * 잔고 부족 방지, 보유 수량 초과 매도 방지
  * Trade/Position/User.balance의 원자적(atomic) 업데이트
  * 포트폴리오 가치:

    * `totalValue = cashBalance + Σ(position.quantity × MP)`
* 수수료는 0 또는 단순 고정 비율(선택).

---

### 7) “가격이 거래로만 움직이게 만드는” 간단한 가격 형성 규칙(필수)

발행량이 가격을 막는 것이 아니라, 거래가 MP를 움직이도록 아래 중 하나 같은 단순 룰을 정의한다:

* (예시) Price Impact 모델:

  * BUY 체결 시: `MP ← MP × (1 + k × tradeValue / liquidity)`
  * SELL 체결 시: `MP ← MP × (1 - k × tradeValue / liquidity)`
  * 여기서 `liquidity`는 종목별 유동성 파라미터(대형은 크게, 소형은 작게 설정 가능)
* 또는 단순 스프레드/영향도 기반 규칙(튜닝 가능 파라미터 포함)

중요:

* 이 룰은 FV가 아니라 **거래(체결)**만 입력으로 받아 MP를 갱신해야 한다.

---

### 8) 봇/AI 캐릭터 참가자(허용): 유동성/거래량 보강

초기 유저 수가 적어 거래가 적은 문제를 해결하기 위해 봇을 도입한다.

* 매일 0~10명 정도의 봇이 랜덤하게 시장에 참여(시간/간격 임의).
* 봇도 유저와 동일한 제약을 따른다:

  * 잔고, 보유 제한, 수수료, 체결 규칙
* 봇은 가격을 직접 설정하지 않는다(거래만 한다).
* 봇 전략은 단순(모멘텀/역추세/랜덤).
* **봇이 FV로 가격을 교정/앵커링하면 안 된다.**

---

### 9) 리서치 지표/표현 매핑(가격 입력이 아님)

금융 느낌의 표현은 “설명/분석”용으로 사용하며, 가격 결정에는 사용하지 않는다.

예시:

* 구독자 수: Audience Base / TAM
* 최근 30일 조회수: Revenue Run-rate
* 조회수 성장률: Revenue Growth
* 조회수/구독자: Engagement / Efficiency

---

### 10) 범위/복잡도 제한

* v1에서는 과도한 복잡도를 피한다.
* 완전한 오더북/매칭 엔진, AMM 등은 지양한다.
* 대신 “가격은 거래로만 움직인다”를 만족하는 최소 규칙과 구현 가능한 MVP를 목표로 한다.

---

### 11) 요청 산출물(Deliverables)

다음을 만들어 달라:

1. v1 시장 사양서: 정의, 불변 조건(invariants), 규칙(가격이 언제/왜 변하는지, 무엇이 변하지 않는지)
2. 거래(체결)에 의해서만 MP가 변하는 **가격 형성 알고리즘**(튜닝 파라미터 포함)
3. 신규 상장 시 **P0 산출 공식**(구독자/누적조회수/최근조회수/쇼츠 0.1 반영) + **발행량 정책**(TOTAL_SUPPLY 고정, 유통/리저브 정의, 소수점 거래 옵션)
4. 0~10명/일 랜덤 참여 봇 설계(전략 단순), 단 FV로 가격 교정 금지
5. DB/모델 아웃라인:

   * Creator(최신 지표, P0, MP, supply 관련 필드, lastSyncedAt)
   * CreatorStat(스냅샷)
   * User(초기 자본 100,000), Position, Trade
   * (선택) User.isBot, BotProfile

**중요 불변 조건(Invariants)**

* FV/YouTube 지표는 MP를 직접 결정/앵커링/강제 이동시키지 않는다.
* 오직 거래 체결만 MP를 변경한다.
* 상장 시 P0 및 발행량/유통량은 반드시 정의된다.
* 봇은 참가자일 뿐 가격 조정 장치가 아니다.
* 구현은 최소/단순/확장 가능하게.
